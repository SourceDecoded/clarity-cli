{"version":3,"sources":["../../src/commands/init-project.js"],"names":["program","version","option","parse","process","argv","args","command","projectName","templateName","templateDirectory","join","__dirname","projectDirectory","cwd","readmeFile","packageJsonFile","mainFile","testFile","existingPackageJson","existingReadme","existingMain","existingTest","Error","console","log","readFile","catch","then","test","main","readme","readJson","json","copy","packageJson","newPackageJson","Object","assign","name","writeJson","writeFile","exec"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;;;kBAEe,UAACA,OAAD,EAAa;;AAExBA,YAAQC,OAAR,CAAgB,OAAhB,EACKC,MADL,CACY,mBADZ,EACiC,gFADjC,EAEKC,KAFL,CAEWC,QAAQC,IAFnB;;AAIA,QAAIC,OAAON,QAAQM,IAAnB;AACA,QAAIC,UAAUD,KAAK,CAAL,CAAd;AACA,QAAIE,cAAcF,KAAK,CAAL,KAAW,EAA7B;AACA,QAAIG,eAAe,uBAAnB;;AAEA,QAAIC,oBAAoB,eAAKC,IAAL,CAAUC,SAAV,EAAqB,kBAArB,EAAyCH,YAAzC,CAAxB;AACA,QAAII,mBAAmBT,QAAQU,GAAR,EAAvB;AACA,QAAIC,aAAa,eAAKJ,IAAL,CAAUE,gBAAV,EAA4B,WAA5B,CAAjB;AACA,QAAIG,kBAAkB,eAAKL,IAAL,CAAUE,gBAAV,EAA4B,cAA5B,CAAtB;AACA,QAAII,WAAW,eAAKN,IAAL,CAAUE,gBAAV,EAA4B,cAA5B,CAAf;AACA,QAAIK,WAAW,eAAKP,IAAL,CAAUE,gBAAV,EAA4B,sBAA5B,CAAf;AACA,QAAIM,sBAAsB,IAA1B;AACA,QAAIC,iBAAiB,IAArB;AACA,QAAIC,eAAe,IAAnB;AACA,QAAIC,eAAe,IAAnB;;AAEA,QAAId,eAAe,IAAnB,EAAyB;AACrB,cAAM,IAAIe,KAAJ,CAAU,gCAAV,CAAN;AACH;;AAEDC,YAAQC,GAAR,CAAY,uBAAZ;AACAD,YAAQC,GAAR,CAAY,gDAAZ;;AAEA,sBAAGC,QAAH,CAAYR,QAAZ,EAAsBS,KAAtB,CAA4B,YAAM;;AAE9BH,gBAAQC,GAAR,CAAY,8BAAZ;AACA,eAAO,IAAP;AAEH,KALD,EAKGG,IALH,CAKQ,UAACC,IAAD,EAAU;;AAEdP,uBAAeO,IAAf;AACAL,gBAAQC,GAAR,CAAY,4CAAZ;AACA,eAAO,kBAAGC,QAAH,CAAYT,QAAZ,CAAP;AAEH,KAXD,EAWGU,KAXH,CAWS,YAAM;;AAEXH,gBAAQC,GAAR,CAAY,0BAAZ;AACA,eAAO,IAAP;AAEH,KAhBD,EAgBGG,IAhBH,CAgBQ,UAACE,IAAD,EAAU;;AAEdN,gBAAQC,GAAR,CAAY,uCAAZ;AACAJ,uBAAeS,IAAf;AACA,eAAO,kBAAGJ,QAAH,CAAYX,UAAZ,CAAP;AAEH,KAtBD,EAsBGY,KAtBH,CAsBS,YAAM;;AAEXH,gBAAQC,GAAR,CAAY,0BAAZ;AACA,eAAO,IAAP;AAEH,KA3BD,EA2BGG,IA3BH,CA2BQ,UAACG,MAAD,EAAY;;AAEhBX,yBAAiBW,MAAjB;;AAEA,YAAIA,UAAU,IAAd,EAAoB;AAChBP,oBAAQC,GAAR,CAAY,uBAAZ;AACH;;AAEDD,gBAAQC,GAAR,CAAY,qCAAZ;AACA,eAAO,kBAAGO,QAAH,CAAYhB,eAAZ,CAAP;AAEH,KAtCD,EAsCGW,KAtCH,CAsCS,YAAM;;AAEXH,gBAAQC,GAAR,CAAY,6BAAZ;AACA,eAAO,EAAP;AAEH,KA3CD,EA2CGG,IA3CH,CA2CQ,UAACK,IAAD,EAAU;;AAEdd,8BAAsBc,IAAtB;AACA,eAAO,kBAAGC,IAAH,CAAQxB,iBAAR,EAA2BG,gBAA3B,CAAP;AAEH,KAhDD,EAgDGe,IAhDH,CAgDQ,YAAM;;AAEVJ,gBAAQC,GAAR,CAAY,2BAAZ;;AAEA,eAAO,kBAAGO,QAAH,CAAYhB,eAAZ,CAAP;AAEH,KAtDD,EAsDGY,IAtDH,CAsDQ,UAACO,WAAD,EAAiB;;AAErB,YAAIC,iBAAiBC,OAAOC,MAAP,CAAc,EAAEC,MAAM/B,WAAR,EAAd,EAAqC2B,WAArC,EAAkDhB,mBAAlD,CAArB;;AAEAK,gBAAQC,GAAR,CAAY,wBAAZ;AACA,eAAO,kBAAGe,SAAH,CAAaxB,eAAb,EAA8BoB,cAA9B,CAAP;AAEH,KA7DD,EA6DGR,IA7DH,CA6DQ,YAAM;;AAEVJ,gBAAQC,GAAR,CAAY,qBAAZ;;AAEA,YAAIL,kBAAkB,IAAtB,EAA4B;AACxBI,oBAAQC,GAAR,CAAY,wBAAZ;AACA,mBAAO,kBAAGgB,SAAH,CAAa1B,UAAb,EAAyBK,cAAzB,CAAP;AACH;AAEJ,KAtED,EAsEGQ,IAtEH,CAsEQ,YAAM;;AAEVJ,gBAAQC,GAAR,CAAY,kBAAZ;;AAEA,YAAIJ,gBAAgB,IAApB,EAA0B;AACtBG,oBAAQC,GAAR,CAAY,wBAAZ;AACA,mBAAO,kBAAGgB,SAAH,CAAaxB,QAAb,EAAuBI,YAAvB,CAAP;AACH;AAEJ,KA/ED,EA+EGO,IA/EH,CA+EQ,YAAM;;AAEVJ,gBAAQC,GAAR,CAAY,uBAAZ;AACA,YAAIH,gBAAgB,IAApB,EAA0B;AACtBE,oBAAQC,GAAR,CAAY,0BAAZ;AACA,mBAAO,kBAAGgB,SAAH,CAAavB,QAAb,EAAuBI,YAAvB,CAAP;AACH;AAEJ,KAvFD,EAuFGM,IAvFH,CAuFQ,YAAM;;AAEVJ,gBAAQC,GAAR,CAAY,2BAAZ;AACAD,gBAAQC,GAAR,CAAY,+CAAZ;;AAEA,eAAO,iCAAaiB,IAAb,CAAkB,aAAlB,EAAiC,EAAE5B,KAAKD,gBAAP,EAAjC,CAAP;AAEH,KA9FD,EA8FGe,IA9FH,CA8FQ,YAAM;;AAEVJ,gBAAQC,GAAR,CAAY,uDAAZ;AAEH,KAlGD;AAoGH,C","file":"init-project.js","sourcesContent":["import fs from \"fs-extra\";\nimport path from \"path\";\nimport childProcess from \"child-process-es6-promise\";\n\nexport default (program) => {\n\n    program.version(\"0.0.1\")\n        .option(\"-t, --type [type]\", \"Type of project. Options are: 'babel' (default), 'system' (dispatcher system).\")\n        .parse(process.argv);\n\n    var args = program.args;\n    var command = args[0];\n    var projectName = args[1] || \"\";\n    var templateName = \"init-project-template\";\n\n    var templateDirectory = path.join(__dirname, \"../../templates/\", templateName);\n    var projectDirectory = process.cwd();\n    var readmeFile = path.join(projectDirectory, \"README.md\");\n    var packageJsonFile = path.join(projectDirectory, \"package.json\");\n    var mainFile = path.join(projectDirectory, \"src/index.js\");\n    var testFile = path.join(projectDirectory, \"src/tests/example.js\");\n    var existingPackageJson = null;\n    var existingReadme = null;\n    var existingMain = null;\n    var existingTest = null;\n\n    if (projectName == null) {\n        throw new Error(\"Please provide a project name.\");\n    }\n\n    console.log(\"Creating template....\");\n    console.log(\"Checking for existing 'tests/example.js' file.\");\n\n    fs.readFile(testFile).catch(() => {\n\n        console.log(\"No 'tests/example.js' found.\");\n        return null;\n\n    }).then((test) => {\n\n        existingTest = test;\n        console.log(\"Checking for existing 'src/index.js' file.\");\n        return fs.readFile(mainFile)\n\n    }).catch(() => {\n\n        console.log(\"No 'src/index.js' found.\");\n        return null;\n\n    }).then((main) => {\n\n        console.log(\"Checking for existing README.md file.\");\n        existingMain = main;\n        return fs.readFile(readmeFile);\n\n    }).catch(() => {\n\n        console.log(\"No README.md file found.\");\n        return null;\n\n    }).then((readme) => {\n\n        existingReadme = readme;\n\n        if (readme == null) {\n            console.log(\"Found README.md file.\");\n        }\n\n        console.log(\"Checking for existing package.json.\");\n        return fs.readJson(packageJsonFile);\n\n    }).catch(() => {\n\n        console.log(\"No package.json file found.\");\n        return {};\n\n    }).then((json) => {\n\n        existingPackageJson = json;\n        return fs.copy(templateDirectory, projectDirectory);\n\n    }).then(() => {\n\n        console.log(\"Modifying package.json...\");\n\n        return fs.readJson(packageJsonFile);\n\n    }).then((packageJson) => {\n\n        var newPackageJson = Object.assign({ name: projectName }, packageJson, existingPackageJson);\n\n        console.log(\"Saving package.json...\");\n        return fs.writeJson(packageJsonFile, newPackageJson);\n\n    }).then(() => {\n\n        console.log(\"Saved package.json.\");\n\n        if (existingReadme != null) {\n            console.log(\"Saving README.md file.\");\n            return fs.writeFile(readmeFile, existingReadme);\n        }\n\n    }).then(() => {\n        \n        console.log(\"Saved README.md.\");\n\n        if (existingMain != null) {\n            console.log(\"Saving 'src/index.js'.\");\n            return fs.writeFile(mainFile, existingMain);\n        }\n\n    }).then(() => {\n\n        console.log(\"Saved 'src/index.js'.\");\n        if (existingTest != null) {\n            console.log(\"Saving 'tests/example.js\");\n            return fs.writeFile(testFile, existingTest);\n        }\n\n    }).then(() => {\n\n        console.log(\"Saved 'tests/example.js'.\");\n        console.log(\"Running npm for you, this may take a while...\");\n\n        return childProcess.exec(\"npm install\", { cwd: projectDirectory });\n\n    }).then(() => {\n\n        console.log(\"Locked and loaded, you are ready to go. Happy coding.\");\n\n    });\n\n}\n"]}